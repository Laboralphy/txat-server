var httpHelper = require('httphelper');
var wsHelper = require('wshelper');
var CONFIG;

function main(aServices) {
	// http server init
	httpHelper.setDocumentRoot(CONFIG.root);
	httpHelper.run(CONFIG.port);
	
	// web socket init
	wsHelper.init(httpHelper.getServer());
	wsHelper.start();
	
	aServices.forEach(function(s) {
		// Services
		wsHelper.addService(s);
	});
	
	
	httpHelper.writeLog('server is listening on port ' + CONFIG.port + '...');
}

function init(c) {
	CONFIG = c;
}


module.exports = {
	run: main,
	init: init
};
