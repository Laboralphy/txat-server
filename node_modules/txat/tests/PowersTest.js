var Powers = require('../Powers.js');

test('levels', function(assert) {
	var p = new Powers();
	assert.ok(!!p, 'powers instantiated');
	assert.equal(p.nLevel, 0, 'user level 0');
	p.preset(2);
	assert.equal(p.nLevel, 2, 'user level 0');
	assert.ok(p.bSend, 'can send');
	assert.ok(p.bReceive, 'can receive');
	assert.ok(p.bInvite, 'can invite');
	assert.ok(p.bKick, 'can kick');
	assert.ok(p.bBan, 'can ban');
	assert.ok(p.bUnban, 'can unban');
	assert.ok(p.bPromote, 'can promote');
	assert.ok(p.bDemote, 'can demote');
	

	p.preset(1);
	assert.equal(p.nLevel, 1, 'user level 1');
	assert.ok(p.bSend, 'can send');
	assert.ok(p.bReceive, 'can receive');
	assert.ok(p.bInvite, 'can invite');
	assert.ok(p.bKick, 'can kick');
	assert.ok(p.bBan, 'can ban');
	assert.ok(p.bUnban, 'can unban');
	
	assert.ok(!p.bPromote, 'cannot promote');
	assert.ok(!p.bDemote, 'cannot demote');

	p.preset(0);
	assert.equal(p.nLevel, 0, 'user level 1');
	assert.ok(p.bSend, 'can send');
	assert.ok(p.bReceive, 'can receive');
	
	assert.ok(!p.bInvite, 'cannot invite');
	assert.ok(!p.bKick, 'cannot kick');
	assert.ok(!p.bBan, 'cannot ban');
	assert.ok(!p.bUnban, 'cannot unban');
	assert.ok(!p.bPromote, 'cannot promote');
	assert.ok(!p.bDemote, 'cannot demote');
	
	p.preset(2);
	
	var p2 = new Powers();
	p2.preset(0);

	var p3 = new Powers();
	p3.preset(0);
	
	assert.equal(p2.nLevel, 0, 'user2 level 0');
	assert.equal(p3.nLevel, 0, 'user3 level 0 too');
	
	p2.promote(p3);
	assert.equal(p3.nLevel, 0, 'user2 cannot promote user3');

	p.promote(p3);
	assert.equal(p3.nLevel, 1, 'user1 can promote user3');
	
});
