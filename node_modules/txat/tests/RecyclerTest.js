var Recycler = require('../Recycler.js');

test('basic', function(assert) {
	var r = new Recycler();
	assert.ok(!!r, 'objet instanciable');
	assert.equal(r.aIds.length, 0, 'aIds is array and is 0 lengthed');
	assert.equal(r.nLastId, 0, 'last id is 0 at init');
});

test('id get', function(assert) {
	var r = new Recycler();
	var id = r.getId();
	assert.equal(id, 1, 'first id should be 1');
});
 
test('instance reset', function(assert) {
	var r = new Recycler();
	var id = r.getId();
	assert.equal(id, 1, 'first id should be 1');
	id = r.getId();
	assert.equal(id, 2, 'next id should be 2');
	r.reset();
	assert.equal(r.aIds.length, 0, 'aIds is now 0 lengthed');
	assert.equal(r.nLastId, 0, 'last id is 0 at reset');
});

test('dispose', function(assert) {
	var r = new Recycler();
	var id;
	id = r.getId();
	id = r.getId();
	id = r.getId();
	assert.equal(id, 3, 'this id shouyld be 3');
	r.disposeId(2);
	assert.deepEqual(r.aIds, [2], 'list inspection, should contain only 2');
	assert.equal(r.nLastId, 3, 'still 3 after dispose');
	id = r.getId();
	assert.equal(id, 2, 'from the dispose array');
	id = r.getId();
	assert.equal(id, 4, 'dispose array was empty, new id');
	assert.deepEqual(r.aIds, [], 'list inspection should be empty');
	id = r.getId();
	id = r.getId();
	id = r.getId();
	assert.equal(id, 7, 'should be 7');
	
	r.disposeId(1);
	r.disposeId(4);
	r.disposeId(3);
	assert.deepEqual(r.aIds, [1, 4, 3], 'list inspection should be this array 1,4,3');
	assert.equal(r.getId(), 1, 'in order (older to most recently disposed 1');
	assert.equal(r.getId(), 4, 'in order (older to most recently disposed 4');
	assert.equal(r.getId(), 3, 'in order (older to most recently disposed 3');
	assert.deepEqual(r.aIds, [], 'no more id');
});
